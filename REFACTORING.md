# Web-UI代码重构说明

本次重构将原来的`webui.py`单文件应用拆分为多个模块，使代码更加组织化、可维护，并遵循了更好的软件工程实践。

## 重构目标

1. 将单一的`webui.py`拆分为多个功能独立的模块
2. 改善代码的组织结构，提高可维护性
3. 遵循软件工程最佳实践
4. 不改变原有功能的前提下优化代码结构

## 拆分策略

我们采用了以下拆分策略：

1. **UI相关代码分离**：
   - `themes.py`: 包含所有主题相关代码
   - `ui_builder.py`: 负责构建UI界面
   - `ui_handlers.py`: 处理UI事件和交互

2. **全局状态管理**：
   - `globals.py`: 集中管理全局变量

3. **业务逻辑分离**：
   - `agent_runners.py`: 封装Agent运行相关逻辑
   - `utils/env_utils.py`: 处理环境变量相关功能

4. **入口点简化**：
   - `app.py`: 新的主入口点，简洁明了

## 模块职责

- **app.py**: 应用程序入口点，处理命令行参数
- **src/globals.py**: 管理全局变量
- **src/agent_runners.py**: 封装Agent运行逻辑
- **src/ui/themes.py**: 管理UI主题
- **src/ui/ui_builder.py**: 构建UI界面
- **src/ui/ui_handlers.py**: 处理UI事件和回调
- **src/utils/env_utils.py**: 处理环境变量相关功能

## 使用新架构的好处

1. **可维护性提升**: 每个模块职责清晰，代码组织更加合理
2. **可扩展性提升**: 可以更容易地添加新功能而不影响现有代码
3. **可测试性提升**: 分离的模块更容易进行单元测试
4. **代码复用**: 功能明确的模块可以在其他项目中复用

## 如何从旧版本升级

要从单文件版本升级到新的模块化版本，只需:

1. 保留旧的`webui.py`作为参考
2. 使用新的`app.py`作为程序入口点

所有功能和特性保持不变，但代码结构更加清晰和可维护。 